<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Site Gerado por IA | Inove Dev</title>
    <!-- Meta tags para evitar cache e garantir que o rob√¥ do LoremFlickr suma -->
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <!-- AOS Animation Library -->
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    <!-- Google Fonts Placeholder (Ser√° preenchido via JS) -->
    <link id="dynamic-fonts" rel="stylesheet" href="">
    
    <style>
        :root { 
            --primary: #0d6efd; 
            --primary-rgb: 13, 110, 253; /* Calculado via JS */
            --secondary: #6c757d; 
            --accent: #0dcaf0;
            --bg-page: #f8f9fa;
            --text-main: #212529;
            --card-bg: #ffffff;
            --font-heading: 'Raleway', sans-serif;
            --font-body: 'Open Sans', sans-serif;
            --border-radius: 15px;
            --shadow-sm: 0 5px 15px rgba(0,0,0,0.05);
            --shadow-lg: 0 15px 30px rgba(0,0,0,0.1);
        }
        
        body { font-family: var(--font-body); background-color: var(--bg-page); color: var(--text-main); overflow-x: hidden; line-height: 1.7; }
        h1, h2, h3, h4, h5 { font-family: var(--font-heading); font-weight: 700; }
        
        /* Navbar Craftivo Style */
        .navbar {
            background: var(--card-bg) !important;
            box-shadow: 0px 2px 15px rgba(0,0,0,0.1);
            padding: 15px 0;
        }
        .navbar-brand { color: #222 !important; font-size: 1.8rem; font-weight: 700; text-transform: uppercase; letter-spacing: 1px; }
        .nav-link { color: #444 !important; font-weight: 600; margin-left: 15px; font-family: var(--font-heading); text-transform: uppercase; font-size: 0.9rem; }
        .nav-link:hover { color: var(--primary) !important; }

        /* Section Titles (Craftivo Signature) */
        .section-title { text-align: center; padding-bottom: 30px; margin-bottom: 30px; }
        .section-title h2 { 
            font-size: 32px; font-weight: bold; text-transform: uppercase; 
            margin-bottom: 20px; padding-bottom: 20px; position: relative; color: var(--text-main); 
        }
        .section-title h2::before { 
            content: ''; position: absolute; display: block; width: 120px; height: 1px; 
            background: #ddd; bottom: 1px; left: calc(50% - 60px); 
        }
        .section-title h2::after { 
            content: ''; position: absolute; display: block; width: 40px; height: 3px; 
            background: var(--primary); bottom: 0; left: calc(50% - 20px); 
        }
        .section-title p { margin-bottom: 0; color: #777; font-style: italic; }

        /* Hero Section */
        #hero {
            min-height: 100vh;
            background-size: cover;
            background-position: center;
            display: flex;
            align-items: center;
            position: relative;
            color: #fff;
            background-attachment: fixed;
        }
        .hero-overlay {
            content: ''; position: absolute; top:0; left:0; right:0; bottom:0;
            background: rgba(0, 0, 0, 0.6); /* Darker overlay for text contrast */
            z-index: 1;
        }
        #hero .container { position: relative; z-index: 2; }
        #hero h1 { font-size: 48px; font-weight: 700; line-height: 1.2; margin-bottom: 20px; }
        #hero p { font-size: 20px; margin-bottom: 30px; color: rgba(255,255,255,0.9); }
        
        /* Buttons */
        .btn-custom {
            background: transparent; color: #fff;
            padding: 12px 40px; 
            border-radius: 50px; 
            border: 2px solid var(--primary);
            transition: 0.3s; font-weight: 600; text-transform: uppercase; letter-spacing: 1px;
            font-family: var(--font-heading);
        }
        .btn-custom:hover { background: var(--primary); color: #fff; }
        
        /* Cards & Boxes */
        .service-box {
            padding: 40px 30px; text-align: center;
            border-radius: 8px;
            background: var(--card-bg);
            box-shadow: 0 10px 29px 0 rgba(68, 88, 144, 0.1);
            height: 100%; transition: 0.3s;
            border: none;
        }
        .service-box:hover { transform: translateY(-5px); }
        
        .service-icon { 
            display: inline-block;
            width: 60px; height: 60px; line-height: 60px;
            background: var(--bg-page); /* Contraste com o card */
            color: var(--primary);
            font-size: 32px; margin-bottom: 20px; transition: 0.3s;
        }
        .service-box:hover .service-icon { color: var(--accent); }

        /* Portfolio */
        .portfolio-item { position: relative; overflow: hidden; border-radius: 8px; margin-bottom: 30px; }
        .portfolio-item img { transition: all 0.3s; width: 100%; }
        .portfolio-item:hover img { transform: scale(1.1); }
        .portfolio-info {
            position: absolute; left: 0; bottom: 0; right: 0;
            background: rgba(0,0,0,0.8); padding: 15px;
            transform: translateY(100%); transition: 0.3s;
            text-align: center;
        }
        .portfolio-item:hover .portfolio-info { transform: translateY(0); }
        .portfolio-info h4 { color: #fff; margin: 0; font-size: 18px; }
        .portfolio-info p { color: #ddd; margin: 0; font-size: 14px; }

        .ai-badge {
            position: fixed; bottom: 20px; right: 20px;
            background: #0D1B2A; color: #fff; padding: 15px;
            border-radius: var(--border-radius); z-index: 9999;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            border: 1px solid rgba(255,255,255,0.1);
            max-width: 300px;
        }

        /* Studio Toolbar */
        .studio-toolbar {
            background: #0D1B2A;
            color: white;
            padding: 5px 15px;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 10000;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-family: 'Montserrat', sans-serif;
            font-size: 12px;
            border-bottom: 2px solid var(--primary);
            height: 45px;
        }
        body { padding-top: 45px; }
        [contenteditable="true"]:hover { outline: 2px dashed var(--primary); cursor: edit; }
        [contenteditable="true"]:focus { outline: 2px solid var(--primary); background: rgba(var(--primary-rgb), 0.05); }
        [contenteditable="true"] { transition: all 0.2s ease; }
        
        /* Pulse animation for instructions */
        @keyframes pulse-text {
            0% { opacity: 0.6; }
            50% { opacity: 1; color: #fff; }
            100% { opacity: 0.6; }
        }
        .instruction-pulse { animation: pulse-text 2s infinite; font-weight: 500; font-size: 11px; }

        /* Color Pickers Styling */
        .color-control { display: flex; align-items: center; gap: 5px; background: rgba(255,255,255,0.05); padding: 2px 8px; border-radius: 4px; border: 1px solid rgba(255,255,255,0.1); }
        .color-control label { font-size: 9px; text-transform: uppercase; opacity: 0.8; margin: 0; font-weight: 700; white-space: nowrap; }
        .color-control select { background: transparent; color: white; border: none; font-size: 11px; cursor: pointer; outline: none; padding: 0 5px; }
        .color-control select option { background: #0D1B2A; color: white; }
        .form-control-color-sm { width: 22px; height: 18px; padding: 0; border: none; background: none; cursor: pointer; border-radius: 2px; }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg fixed-top" style="top: 45px; padding: 10px 0;">
        <div class="container">
            <a class="navbar-brand fw-bold" href="#" id="navBrand">Logo</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"><span class="navbar-toggler-icon"></span></button>
            <div class="collapse navbar-collapse">
                <ul class="navbar-nav ms-auto" id="navbarNav">
                    <li class="nav-item"><a class="nav-link" href="#hero">In√≠cio</a></li>
                    <li class="nav-item"><a class="nav-link" href="#about">Sobre</a></li>
                    <li class="nav-item"><a class="nav-link" href="#services">Servi√ßos</a></li>
                    <li class="nav-item"><a class="nav-link" href="#portfolio">Portf√≥lio</a></li>
                    <li class="nav-item"><a class="nav-link" href="#contact">Contato</a></li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="studio-toolbar">
        <div class="d-flex align-items-center">
            <i class="bi bi-stars text-primary me-1"></i>
            <strong class="d-none d-sm-inline">Inove AI Studio</strong>
            <span class="badge bg-primary ms-2" style="font-size: 9px; padding: 3px 6px;">EDI√á√ÉO ATIVA</span>
        </div>
        
        <div class="d-flex align-items-center gap-2">
            <div class="color-control">
                <label title="Cor da Marca"><i class="bi bi-palette"></i></label>
                <input type="color" id="pickerPrimary" class="form-control-color-sm" title="Cor Principal">
            </div>
            <div class="color-control">
                <label title="Cor de Fundo"><i class="bi bi-paint-bucket"></i></label>
                <input type="color" id="pickerBg" class="form-control-color-sm" title="Cor de Fundo">
            </div>
            <div class="color-control">
                <label title="Cor do Texto"><i class="bi bi-type"></i></label>
                <input type="color" id="pickerText" class="form-control-color-sm" title="Cor do Texto">
            </div>
            <div class="color-control" id="individualColorWrapper" style="display:none; border-color: var(--primary); background: rgba(var(--primary-rgb), 0.2);">
                <label><i class="bi bi-cursor-fill"></i> Item</label>
                <input type="color" id="pickerIndividualText" class="form-control-color-sm" title="Cor do Item Selecionado">
            </div>
            <div class="color-control d-none d-md-flex">
                <label><i class="bi bi-font"></i></label>
                <select id="pickerFont">
                    <option value="'Montserrat', sans-serif">Moderno</option>
                    <option value="'Playfair Display', serif">Cl√°ssico</option>
                    <option value="'Open Sans', sans-serif">Clean</option>
                    <option value="'Raleway', sans-serif">Elegante</option>
                    <option value="'Dancing Script', cursive">Rom√¢ntico</option>
                </select>
            </div>
            <button id="btnReset" class="btn btn-link text-danger p-0 ms-1" title="Resetar Design">
                <i class="bi bi-trash" style="font-size: 16px;"></i>
            </button>
            <button id="btnDownload" class="btn btn-link text-white-50 p-0 ms-1" title="Baixar C√≥digo Fonte (Restrito)">
                <i class="bi bi-code-slash" style="font-size: 16px;"></i>
            </button>
            <button id="btnFinalize" class="btn btn-primary btn-sm fw-bold ms-2" style="font-size: 11px; padding: 4px 12px;">
                <i class="bi bi-whatsapp me-1"></i> FINALIZAR
            </button>
        </div>
        <div class="d-none d-xl-block text-white-50 instruction-pulse">
            <i class="bi bi-info-circle me-1"></i> Clique nos textos para editar
        </div>
    </div>
    <section id="hero">
        <div class="hero-overlay"></div>
        <div class="container text-center">
            <div class="row justify-content-center">
                <div class="col-lg-10" data-aos="fade-up" data-aos-duration="1000">
                    <h1 class="display-2 mb-4" id="heroTitle">Carregando...</h1>
                    <p class="lead mb-5 fs-3" id="heroSubtitle">Aguarde enquanto a IA constr√≥i seu site.</p>
                    <a href="#contact" class="btn-custom" id="heroCTA">Saiba Mais</a>
                </div>
            </div>
        </div>
    </section>

    <section id="about" class="py-5">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-lg-6" data-aos="fade-right">
                    <img src="" id="aboutImg" class="img-fluid rounded shadow" alt="Sobre">
                </div>
                <div class="col-lg-6 mt-4 mt-lg-0" data-aos="fade-left">
                    <h5 class="text-uppercase" style="color: var(--accent);">Nossa Hist√≥ria</h5>
                    <h2 class="mb-4" id="aboutTitle">Sobre N√≥s</h2>
                    <p class="lead" id="aboutText">...</p>
                    
                    <div class="row mt-5" id="statsGrid">
                        <!-- Stats via JS -->
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section id="services" class="py-5">
        <div class="container">
            <div class="section-title" data-aos="fade-up">
                <h2 id="servicesTitle">Nossos Servi√ßos</h2>
                <p id="servicesSubtitle">Solu√ß√µes completas desenvolvidas para impulsionar o seu neg√≥cio.</p>
            </div>
            <div class="row g-4" id="servicesGrid">
                <!-- Inserido via JS -->
            </div>
        </div>
    </section>

    <!-- Portfolio Section (Novo) -->
    <section id="portfolio" class="py-5">
        <div class="container">
            <div class="section-title" data-aos="fade-up">
                <h2 id="portfolioTitle">Portf√≥lio</h2>
                <p id="portfolioSubtitle">Confira alguns dos nossos projetos recentes.</p>
            </div>
            <div class="row g-4" id="portfolioGrid">
                <!-- Inserido via JS -->
            </div>
        </div>
    </section>

    <section id="features" class="py-5">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-lg-6 order-2 order-lg-1" data-aos="fade-up">
                    <h2 class="mb-4" id="featuresTitle">Por que nos escolher?</h2>
                    <div class="row g-4" id="featuresGrid">
                        <!-- Features via JS -->
                    </div>
                </div>
                <div class="col-lg-6 order-1 order-lg-2 mb-4 mb-lg-0" data-aos="zoom-in">
                    <img src="" id="featureImg" class="img-fluid rounded shadow-lg" alt="Destaque">
                </div>
            </div>
        </div>
    </section>

    <section id="testimonials" class="py-5">
        <div class="container">
            <div class="section-title" data-aos="fade-down">
                <h2 id="testimonialsTitle">O que dizem nossos clientes</h2>
            </div>
            <div class="row justify-content-center" id="testimonialsGrid">
                <!-- Testimonials via JS -->
            </div>
        </div>
    </section>

    <section id="contact" class="py-5">
        <div class="container">
            <div class="section-title" data-aos="fade-up">
                <h2 id="contactTitle">Contato</h2>
                <p id="contactSubtitle">Estamos prontos para atender voc√™.</p>
            </div>
            <div class="row justify-content-center text-center" data-aos="fade-up">
                <div class="col-lg-8">
                    
                    <div class="row g-4 mb-5">
                        <div class="col-md-4" data-aos="flip-left" data-aos-delay="100">
                            <div class="p-4 rounded shadow-sm h-100" style="background: var(--card-bg);">
                                <i class="bi bi-geo-alt fs-2" style="color: var(--accent);"></i>
                            <h5 class="mt-2">Endere√ßo</h5>
                            <p id="contactAddress">...</p>
                            </div>
                        </div>
                        <div class="col-md-4" data-aos="flip-left" data-aos-delay="200">
                            <div class="p-4 rounded shadow-sm h-100" style="background: var(--card-bg);">
                                <i class="bi bi-envelope fs-2" style="color: var(--accent);"></i>
                            <h5 class="mt-2">Email</h5>
                            <p id="contactEmail">...</p>
                            </div>
                        </div>
                        <div class="col-md-4" data-aos="flip-left" data-aos-delay="300">
                            <div class="p-4 rounded shadow-sm h-100" style="background: var(--card-bg);">
                                <i class="bi bi-telephone fs-2" style="color: var(--accent);"></i>
                            <h5 class="mt-2">Telefone</h5>
                            <p id="contactPhone">...</p>
                            </div>
                        </div>
                    </div>

                    <a href="#" class="btn-custom" id="contactCTA">Falar no WhatsApp</a>
                </div>
            </div>
        </div>
    </section>

    <footer class="py-5 text-white" style="background-color: #1a1a1a;">
        <div class="container">
            <div class="row">
                <div class="col-md-4 mb-4">
                    <h3 id="footerBrand" class="fw-bold mb-3">Logo</h3>
                    <p class="text-secondary">Criado com tecnologia de ponta para impulsionar seu neg√≥cio.</p>
                </div>
                <div class="col-md-4 mb-4">
                    <h5 class="mb-3">Links R√°pidos</h5>
                    <ul class="list-unstyled">
                        <li><a href="#hero" class="text-secondary text-decoration-none">In√≠cio</a></li>
                        <li><a href="#about" class="text-secondary text-decoration-none">Sobre</a></li>
                        <li><a href="#services" class="text-secondary text-decoration-none">Servi√ßos</a></li>
                    </ul>
                </div>
                <div class="col-md-4 mb-4">
                    <h5 class="mb-3">Legal</h5>
                    <p class="text-secondary mb-0">&copy; <span id="footerYear"></span> Todos os direitos reservados.</p>
                </div>
            </div>
        </div>
    </footer>

    <div class="ai-badge">
        <small>Gerado por Inove AI</small><br>
        <p class="mb-2" style="font-size: 11px; opacity: 0.7; line-height: 1.3;">Nota: As imagens s√£o selecionadas automaticamente baseadas no tema.</p>
        <a href="https://wa.me/5581989035561" class="btn btn-success btn-sm mt-2 w-100">Contratar Site Real</a>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // 0. Prioridade 1: Dados embutidos (vers√£o baixada)
            let data = window.bakedData || null;

            // 1. Prioridade 2: Dados da URL (Fragmento # ou Query ?)
            if (!data) {
                // Tenta pegar do fragmento (#s=) primeiro para evitar erro 431
                let stateParam = null;
                if (window.location.hash.startsWith('#s=')) {
                    stateParam = window.location.hash.substring(3);
                } else {
                    // Fallback para o m√©todo antigo (?s=)
                    stateParam = new URLSearchParams(window.location.search).get('s');
                }

                if (stateParam) {
                    try {
                        const binary = atob(stateParam);
                        const bytes = new Uint8Array(binary.length);
                        for (let i = 0; i < binary.length; i++) bytes[i] = binary.charCodeAt(i);
                        data = JSON.parse(new TextDecoder().decode(bytes));

                        // Feedback visual de que √© um design compartilhado
                        const toolbar = document.querySelector('.studio-toolbar');
                        if(toolbar) toolbar.innerHTML += `<span class="badge bg-warning ms-2 text-dark" style="font-size:10px">Design do Cliente</span>`;
                    } catch (e) {
                        console.error("Erro ao carregar design da URL:", e);
                    }
                }
            }

            // 2. Se n√£o houver URL v√°lida, carrega do localStorage
            if (!data) {
                const urlParams = new URLSearchParams(window.location.search);
                const siteId = urlParams.get('id');
                if (siteId) {
                    data = JSON.parse(localStorage.getItem(`ai_site_${siteId}`));
                }
                if (!data) {
                    data = JSON.parse(localStorage.getItem('aiWebsiteData_v3'));
                }
            }
            if (!data) {
                alert('Nenhum dado encontrado. Volte e gere novamente.');
                return;
            }

            // Renderizar o site diretamente (Universal Template Engine)
            renderSite(data);
        });

        function renderSite(data) {
            const saveToLocal = () => {
                localStorage.setItem('aiWebsiteData_v3', JSON.stringify(data));
            };
            
            // Garantir que objeto de imagens exista para evitar erros
            if (!data.images) data.images = {};

            // --- L√ìGICA DE PROXY DE TEMPLATE (NOVO) ---
            // Se um template espec√≠fico foi escolhido, carregamos ele em vez do layout padr√£o
            if (data.templateSource) {
                // Garante que os dados estejam salvos para o ai-integration.js ler no novo contexto
                localStorage.setItem('aiWebsiteData_v3', JSON.stringify(data));

                const slug = data.templateSource.toLowerCase().replace(/[^a-z0-9]/g, '');
                const templatePath = `templates/${slug}/index.html`;

                console.log(`ü§ñ Tentando carregar template: ${templatePath}`);

                fetch(templatePath)
                    .then(response => {
                        if (!response.ok) throw new Error("Template n√£o encontrado");
                        return response.text();
                    })
                    .then(html => {
                        // 1. Corrigir caminhos relativos (assets/ -> templates/slug/assets/)
                        const basePath = `templates/${slug}/`;
                        let fixedHtml = html.replace(/(src|href)=["']([^"']+)["']/g, (match, attr, url) => {
                            // Se for script de integra√ß√£o ou script global, ajusta para a raiz
                            if (url.includes('ai-integration.js') || url.includes('script.js')) {
                                return `${attr}="js/${url.split('/').pop()}"`;
                            }
                            // Se for assets do template, adiciona o prefixo da pasta
                            if (url.startsWith('assets/') || url.startsWith('css/') || url.startsWith('js/')) {
                                return `${attr}="${basePath}${url}"`;
                            }
                            return match;
                        });

                        // 2. Garantir que o script de integra√ß√£o (Studio) esteja presente
                        // Isso garante que a barra de ferramentas e a edi√ß√£o funcionem no template carregado
                        if (!fixedHtml.includes('ai-integration.js')) {
                            fixedHtml = fixedHtml.replace('</body>', '<script src="js/ai-integration.js"></script></body>');
                        }

                        // Substitui o corpo do documento atual pelo do template
                        document.open();
                        document.write(fixedHtml);
                        document.close();

                        
                        return; // Interrompe a renderiza√ß√£o do layout padr√£o
                    })
                    .catch(e => {
                        console.warn("‚ö†Ô∏è Falha ao carregar template, usando layout universal:", e);
                        // Continua para o c√≥digo abaixo (Layout Universal)
                    });
            }
            // -------------------------------------------

            // 0. Aplicar Classe do Template ao Body (Para permitir CSS espec√≠fico)
            if (data.templateSource) {
                const themeClass = 'theme-' + data.templateSource.toLowerCase().replace(/[^a-z0-9]/g, '-');
                document.body.classList.add(themeClass);
            }

            // 1. Configurar Cores e Vari√°veis CSS
            if (data.colors) {
                const root = document.documentElement;
                const getContrastYIQ = (hexcolor) => {
                    if (!hexcolor) return '#212529';
                    hexcolor = hexcolor.replace('#', '');
                    var r = parseInt(hexcolor.substr(0,2),16);
                    var g = parseInt(hexcolor.substr(2,2),16);
                    var b = parseInt(hexcolor.substr(4,2),16);
                    var yiq = ((r*299)+(g*587)+(b*114))/1000;
                    return (yiq >= 128) ? '#212529' : '#ffffff';
                }

                root.style.setProperty('--primary', data.colors.primary);
                root.style.setProperty('--secondary', data.colors.secondary);
                root.style.setProperty('--accent', data.colors.accent || data.colors.primary);
                root.style.setProperty('--bg-page', data.colors.background || '#f8f9fa');
                
                // For√ßa a cor do texto baseada no c√°lculo matem√°tico de contraste, ignorando a IA se necess√°rio
                const safeTextColor = getContrastYIQ(data.colors.background || '#f8f9fa');
                root.style.setProperty('--text-main', safeTextColor);
                
                root.style.setProperty('--card-bg', data.colors.card_bg || '#ffffff');
            }

            // 2. Carregar Fontes do Google
            if (data.fonts) {
                const fontHeading = data.fonts.heading || 'Raleway';
                const fontBody = data.fonts.body || 'Open Sans';
                const fontUrl = `https://fonts.googleapis.com/css2?family=${fontHeading.replace(/ /g, '+')}:wght@300;400;600;700&family=${fontBody.replace(/ /g, '+')}:wght@300;400;600&display=swap`;
                document.getElementById('dynamic-fonts').href = fontUrl;
                
                document.documentElement.style.setProperty('--font-heading', `'${fontHeading}', sans-serif`);
                document.documentElement.style.setProperty('--font-body', `'${fontBody}', sans-serif`);
            }

            // 3. Injetar CSS Personalizado (IA)
            if (data.customCss) {
                const style = document.createElement('style');
                style.innerHTML = data.customCss;
                document.head.appendChild(style);
            }

            // 4. Preencher Conte√∫do de Texto
            const elements = {
                'brandName': data.brandName,
                'navBrand': data.brandName,
                'footerBrand': data.brandName,
                'heroTitle': data.hero?.title,
                'heroSubtitle': data.hero?.subtitle,
                'heroCTA': data.hero?.cta,
                'aboutTitle': data.about?.title,
                'aboutText': data.about?.text,
                'contactAddress': data.contact?.address,
                'contactEmail': data.contact?.email,
                'contactPhone': data.contact?.phone,
                'contactCTA': data.contact?.cta_text,
                'footerYear': new Date().getFullYear(),
                // T√≠tulos Din√¢micos das Se√ß√µes
                'servicesTitle': data.sectionTitles?.services,
                'servicesSubtitle': data.sectionTitles?.services_subtitle,
                'portfolioTitle': data.sectionTitles?.portfolio,
                'portfolioSubtitle': data.sectionTitles?.portfolio_subtitle,
                'featuresTitle': data.sectionTitles?.features,
                'testimonialsTitle': data.sectionTitles?.testimonials,
                'contactTitle': data.sectionTitles?.contact,
                'contactSubtitle': data.sectionTitles?.contact_subtitle
            };

            Object.keys(elements).forEach(id => {
                const el = document.getElementById(id);
                if (el && elements[id]) el.textContent = elements[id];
            });

            // 5. Layout do Hero (Ajuste Estrutural)
            const heroSection = document.getElementById('hero');
            const heroContainer = heroSection.querySelector('.container');
            
            if (data.layout?.heroStyle === 'split-left' || data.layout?.heroStyle === 'split-right') {
                heroContainer.innerHTML = `
                    <div class="row align-items-center">
                        <div class="col-lg-6 ${data.layout.heroStyle === 'split-right' ? 'order-lg-2' : ''}">
                            <img src="${data.images?.hero}" class="img-fluid rounded shadow-lg" alt="Hero Image" data-aos="zoom-in">
                        </div>
                        <div class="col-lg-6 ${data.layout.heroStyle === 'split-right' ? 'order-lg-1' : ''}">
                            <h1 class="display-3 fw-bold mb-4">${data.hero?.title}</h1>
                            <p class="lead mb-4">${data.hero?.subtitle}</p>
                            <h1 class="display-3 fw-bold mb-4" contenteditable="true" data-path="hero.title">${data.hero?.title}</h1>
                            <p class="lead mb-4" contenteditable="true" data-path="hero.subtitle">${data.hero?.subtitle}</p>
                            <a href="#contact" class="btn-custom">${data.hero?.cta || 'Saiba Mais'}</a>
                        </div>
                    </div>
                `;
                // Remove overlay for split layout to make it cleaner
                const overlay = heroSection.querySelector('.hero-overlay');
                if(overlay) overlay.style.display = 'none';
                heroSection.style.backgroundImage = 'none';
                heroSection.style.backgroundColor = data.colors?.background || '#f8f9fa';
                heroSection.style.color = data.colors?.text || '#333';
            } else {
                // Default Center
                if (data.images?.hero) {
                    heroSection.style.backgroundImage = `url(${data.images.hero})`;
                }
            }

            // 6. Imagens Gerais
            if (data.images) {
                const imgMap = {
                    'aboutImg': data.images.about,
                    'featureImg': data.images.feature
                };
                Object.keys(imgMap).forEach(id => {
                    const el = document.getElementById(id);
                    if (el && imgMap[id]) {
                        el.src = imgMap[id];
                        // Fallback de seguran√ßa: Se a imagem falhar, carrega um placeholder profissional
                        el.onerror = function() {
                            this.onerror = null;
                            this.src = 'https://images.unsplash.com/photo-1497366216548-37526070297c?auto=format&fit=crop&w=800&q=80';
                            this.alt = 'Imagem indispon√≠vel';
                        };
                    }
                });
            }

            // 7. Renderizar Listas (Servi√ßos, Features, Portfolio, Testimonials)
            if (data.services) {
                const servicesContainer = document.querySelector('#services .row') || document.getElementById('servicesGrid');
                if (servicesContainer) {
                    servicesContainer.innerHTML = '';
                    data.services.forEach((service, idx) => {
                        const col = document.createElement('div');
                        col.className = 'col-lg-4 col-md-6 d-flex align-items-stretch mb-4';
                        col.setAttribute('data-aos', 'fade-up');
                        const titlePath = `services.${idx}.title`;
                        const descPath = `services.${idx}.desc`;
                        
                        const titleColor = (data.individualColors && data.individualColors[titlePath]) || 'inherit';
                        const descColor = (data.individualColors && data.individualColors[descPath]) || 'inherit';

                        col.innerHTML = `
                            <div class="service-box w-100">
                                <div class="service-icon"><i class="bi ${service.icon || 'bi-check-circle'}"></i></div>
                                <h4 data-path="${titlePath}" style="color:${titleColor}">${service.title}</h4>
                                <p class="text-muted" data-path="${descPath}" style="color:${descColor}">${service.desc}</p>
                            </div>
                        `;
                        servicesContainer.appendChild(col);
                    });
                }
            }

            if (data.features) {
                const featuresGrid = document.getElementById('featuresGrid');
                if (featuresGrid) {
                    featuresGrid.innerHTML = '';
                    data.features.forEach((feat, idx) => {
                        const titlePath = `features.${idx}.title`;
                        const titleColor = (data.individualColors && data.individualColors[titlePath]) || 'inherit';
                        
                        featuresGrid.innerHTML += `
                            <div class="col-md-6">
                                <div class="d-flex align-items-start">
                                    <i class="bi ${feat.icon || 'bi-check-circle-fill'} fs-4 me-3" style="color: var(--primary);"></i>
                                    <div>
                                        <h5 class="fw-bold" data-path="${titlePath}" style="color:${titleColor}">${feat.title}</h5>
                                        <p class="small text-muted">${feat.desc}</p>
                                    </div>
                                </div>
                            </div>
                        `;
                    });
                }
            }

            if (data.portfolio) {
                const portfolioGrid = document.getElementById('portfolioGrid');
                if (portfolioGrid) {
                    portfolioGrid.innerHTML = '';
                    data.portfolio.forEach((item, index) => {
                        // Generate a random image for portfolio if not provided specifically
                        const pImg = (data.images && data.images.portfolio) ? data.images.portfolio + `&i=${index}` : `https://source.unsplash.com/random/800x600?${data.niche},${index}`;
                        const titlePath = `portfolio.${index}.title`;
                        const titleColor = (data.individualColors && data.individualColors[titlePath]) || 'inherit';
                        
                        portfolioGrid.innerHTML += `
                            <div class="col-lg-4 col-md-6" data-aos="fade-up" data-aos-delay="${index * 100}">
                                <div class="portfolio-item shadow">
                                    <img src="${pImg}" class="img-fluid" alt="${item.title}" onerror="this.src='https://images.unsplash.com/photo-1460925895917-afdab827c52f?auto=format&fit=crop&w=800&q=80'">
                                    <div class="portfolio-info">
                                        <h4 data-path="${titlePath}" style="color:${titleColor}">${item.title}</h4>
                                        <p>${item.category}</p>
                                    </div>
                                </div>
                            </div>
                        `;
                    });
                }
            }

            if (data.testimonials) {
                const testGrid = document.getElementById('testimonialsGrid');
                if (testGrid) {
                    testGrid.innerHTML = '';
                    data.testimonials.forEach((t, idx) => {
                        const textPath = `testimonials.${idx}.text`;
                        const textColor = (data.individualColors && data.individualColors[textPath]) || 'inherit';
                        
                        testGrid.innerHTML += `
                            <div class="col-md-4 mb-4" data-aos="fade-up">
                                <div class="card border-0 shadow-sm h-100 p-4 text-center" style="background: var(--card-bg);">
                                    <div class="mb-3 text-warning">
                                        <i class="bi bi-star-fill"></i><i class="bi bi-star-fill"></i><i class="bi bi-star-fill"></i><i class="bi bi-star-fill"></i><i class="bi bi-star-fill"></i>
                                    </div>
                                    <p class="fst-italic" data-path="${textPath}" style="color:${textColor}">"${t.text}"</p>
                                    <h6 class="fw-bold mt-3 mb-0">${t.name}</h6>
                                    <small class="text-muted">${t.role || 'Cliente'}</small>
                                </div>
                            </div>
                        `;
                    });
                }
            }

            if (data.about?.stats) {
                const statsGrid = document.getElementById('statsGrid');
                if (statsGrid) {
                    statsGrid.innerHTML = '';
                    data.about.stats.forEach(stat => {
                        statsGrid.innerHTML += `
                            <div class="col-4 text-center">
                                <h3 class="fw-bold display-6" style="color: var(--primary);">${stat.number}</h3>
                                <p class="small text-uppercase fw-bold text-muted">${stat.label}</p>
                            </div>
                        `;
                    });
                }
            }

            // 8. Inicializar Anima√ß√µes
            if (typeof AOS !== 'undefined') {
                AOS.init();
            }

            // 9. Habilitar Edi√ß√£o em Tempo Real (Diferencial Inove)
            const editableSelectors = '[contenteditable="true"], h1, h2, h3, h4, h5, p, .nav-link, .btn-custom';
            document.querySelectorAll(editableSelectors).forEach(el => {
                if (el.children.length === 0 || (el.tagName === 'P' || el.tagName.startsWith('H'))) {
                    el.setAttribute('contenteditable', 'true');
                    el.setAttribute('spellcheck', 'false');
                }
            });

            // 10. Controles de Cores em Tempo Real
            const pPrimary = document.getElementById('pickerPrimary'), pBg = document.getElementById('pickerBg'), pText = document.getElementById('pickerText'), pFont = document.getElementById('pickerFont'), pIndividual = document.getElementById('pickerIndividualText'), individualWrapper = document.getElementById('individualColorWrapper'), btnFinalize = document.getElementById('btnFinalize'), btnDownload = document.getElementById('btnDownload'), btnReset = document.getElementById('btnReset');

            document.addEventListener('input', (e) => {
                const path = e.target.dataset.path;
                if (path) {
                    const keys = path.split('.');
                    let obj = data;
                    for (let i = 0; i < keys.length - 1; i++) { if(!obj[keys[i]]) obj[keys[i]] = {}; obj = obj[keys[i]]; }
                    obj[keys[keys.length - 1]] = e.target.innerText;
                    saveToLocal();
                }
            });

            if (data.colors) {
                pPrimary.value = data.colors.primary || '#0d6efd';
                pBg.value = data.colors.background || '#f8f9fa';
                pText.value = data.colors.text || '#212529';
            }

            // L√≥gica de Sele√ß√£o de Elemento para Cor Individual
            let lastFocusedEl = null;

            document.addEventListener('focusin', (e) => {
                if (e.target.hasAttribute('contenteditable')) {
                    lastFocusedEl = e.target;
                    individualWrapper.style.display = 'flex';
                    
                    // Pega a cor atual do elemento (convertendo para HEX para o input color)
                    const rgb = window.getComputedStyle(lastFocusedEl).color;
                    const hex = rgbToHex(rgb);
                    pIndividual.value = hex;
                } else {
                    // Se clicar fora de um edit√°vel, esconde o seletor individual
                    if (!e.target.closest('#individualColorWrapper')) {
                        individualWrapper.style.display = 'none';
                    }
                }
            });

            function rgbToHex(rgb) {
                const vals = rgb.match(/\d+/g);
                if (!vals) return '#000000';
                return "#" + vals.map(x => {
                    const hex = parseInt(x).toString(16);
                    return hex.length === 1 ? "0" + hex : hex;
                }).slice(0,3).join("");
            }

            pPrimary.addEventListener('input', (e) => {
                const val = e.target.value;
                document.documentElement.style.setProperty('--primary', val);
                data.colors.primary = val;
                saveToLocal();
            });
            pBg.addEventListener('input', (e) => {
                const val = e.target.value;
                document.documentElement.style.setProperty('--bg-page', val);
                data.colors.background = val;
                saveToLocal();
            });
            pText.addEventListener('input', (e) => {
                const val = e.target.value;
                document.documentElement.style.setProperty('--text-main', val);
                data.colors.text = val;
                saveToLocal();
            });
            pFont.addEventListener('change', (e) => {
                const val = e.target.value;
                document.documentElement.style.setProperty('--font-heading', val);
                document.documentElement.style.setProperty('--font-body', val);
                data.fonts = { heading: val, body: val };
                saveToLocal();
            });

            pIndividual.addEventListener('input', (e) => {
                if (lastFocusedEl) {
                    const val = e.target.value;
                    lastFocusedEl.style.color = val;
                    
                    // Salva a cor individual no objeto data
                    if (!data.individualColors) data.individualColors = {};
                    const path = lastFocusedEl.dataset.path;
                    if (path) {
                        data.individualColors[path] = val;
                        saveToLocal();
                    }
                }
            });

            // 11. Finalizar e Enviar (Captura o estado atual da tela)
            btnFinalize.addEventListener('click', () => {
                // Codifica o objeto DATA completo para a URL
                const jsonStr = JSON.stringify(data);
                const bytes = new TextEncoder().encode(jsonStr);
                const encodedState = btoa(String.fromCharCode(...bytes));
                
                // Gera o link apenas com o estado codificado, preservando par√¢metros como ?v=
                const baseUrl = window.location.href.split('#')[0];
                const shareLink = `${baseUrl}#s=${encodedState}`;
                
                window.open(`https://wa.me/5581989035561?text=${encodeURIComponent(shareLink)}`, '_blank');
            });

            // 11.5 Resetar Design
            btnReset.addEventListener('click', () => {
                if(confirm("Deseja descartar todas as suas altera√ß√µes e voltar ao design original da IA?")) {
                    localStorage.removeItem('aiWebsiteData_v3');
                    window.location.href = window.location.href.split('#')[0].split('?')[0];
                }
            });

            // 12. Download do C√≥digo Fonte (Protegido por Senha)
            btnDownload.addEventListener('click', async () => {
                const password = prompt("Digite a senha de desenvolvedor para baixar o c√≥digo fonte:");
                
                if (!password) return;

                // Fun√ß√£o para gerar Hash SHA-256
                const getHash = async (str) => {
                    const msgBuffer = new TextEncoder().encode(str);
                    const hashBuffer = await crypto.subtle.digest('SHA-256', msgBuffer);
                    const hashArray = Array.from(new Uint8Array(hashBuffer));
                    return hashArray.map(b => b.toString(16).padStart(2, '0')).join('');
                };

                const inputHash = await getHash(password);
                // Verifica√ß√£o via Hash SHA-256 da senha Mg156810$
                if (inputHash === "e1a7808c06bc66de3cb20a222f610349429d5e91e3c3e00112d4751ab4565cf6") {
                    // Clona o documento para limpar elementos do Studio antes de baixar
                    const exportDoc = document.documentElement.cloneNode(true);
                    
                    // Remove a barra de ferramentas e o badge de IA do arquivo exportado
                    const toolbar = exportDoc.querySelector('.studio-toolbar');
                    const badge = exportDoc.querySelector('.ai-badge');
                    const scripts = exportDoc.querySelectorAll('script');
                    
                    if (toolbar) toolbar.remove();
                    if (badge) badge.remove();
                    
                    // Injeta os dados atuais diretamente no arquivo baixado
                    const dataScript = exportDoc.createElement('script');
                    dataScript.textContent = `window.bakedData = ${JSON.stringify(data)};`;
                    exportDoc.head.prepend(dataScript);
                    
                    // Gera o Blob do HTML limpo
                    const htmlContent = "<!DOCTYPE html>\n" + exportDoc.outerHTML;
                    const blob = new Blob([htmlContent], { type: 'text/html' });
                    const url = URL.createObjectURL(blob);
                    
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = `projeto-${data.brandName.toLowerCase().replace(/\s+/g, '-')}.html`;
                    a.click();
                } else if (password !== null) {
                    alert("Acesso negado: Senha incorreta.");
                }
            });
        }
    </script>
</body>
</html>